<p-growl [value]="msgs"></p-growl>

<div *ngIf="finalizado" style="margin: 20px;">
  <h2>Inspección finalizada</h2>
  <br/>
  <a (click)="volver()">Volver</a>
</div>
<p-progressBar *ngIf="initLoading" mode="indeterminate" [style]="{'height': '6px'}"></p-progressBar>

<div *ngIf="!finalizado && initLoading == false" id="contenedor">
  <p-panel>
    <p-header>
      <div style="float: left;">
        <button *ngIf="!adicionar" pButton icon="fa fa-print" (click)="imprimir()" class="soft-icon"></button>
        {{listaInspeccion?.nombre}}

      </div>
      <div style="float: right;">
        {{listaInspeccion?.codigo}} | Versión: {{listaInspeccion?.listaInspeccionPK.version}}
         <p> Ubicacion: {{programacion ? programacion.area.nombre : "" }}</p>

      </div>
    </p-header>
    
    <p>
      {{listaInspeccion?.descripcion}}
    </p>
    <br>
    <div class="uploaders"  *ngIf="listaEvidence.length > 0 ">
      <app-file-uploader *ngFor="let evidence of listaEvidence; let i = index" [img]="evidence" [index]="i"
          [show]="true">
      </app-file-uploader>
    </div> 
  </p-panel>
  <br/>
  <s-formulario *ngIf="listaInspeccion?.formulario" [formularioModel]="listaInspeccion?.formulario" (onValidChange)="actualizarValidacion($event)"></s-formulario>
  <br/>
  <s-lista-inspeccion-form [value]="listaInspeccion?.elementoInspeccionList" [opciones]="listaInspeccion?.opcionCalificacionList"
    [editable]="false" [disabled]="consultar" [nivelRiesgoList]="nivelRiesgoList" diligenciable="true" #listaInspeccionForm
    [usarNivelRiesgo]="listaInspeccion?.usarNivelRiesgo" [usarTipoHallazgo]="listaInspeccion?.usarTipoHallazgo"></s-lista-inspeccion-form>
    <!-- ss
    <div class="ui-g-12 ui-sm-12 ui-md-6" >
      <form  [formGroup]="Form">
          <p-panel  >
              <p-header>
                  <i class="fa fa-list" aria-hidden="true"></i> Visto Bueno supervision / Ingenieria
              </p-header>
              <div class="input-field">
                <p-autoComplete styleClass="form-material-autocomplete" #autocomplete placeholder="Digite" [style]="{'width':'100%'}" (onSelect)="onSelection($event)" [suggestions]="empleadosList" (completeMethod)="buscarEmpleado($event)" formControlName="numeroIdentificacion"
                    *ngIf="empleado?.id == null">
                    <ng-template let-empleado pTemplate="item">
                        <div class="ui-helper-clearfix">
                            <div class="wrapper">
                                <i *ngIf="!empleado.usuario?.icon" class="fa fa-user-circle" style="font-size: 48px;" aria-hidden="true"></i>
                                <img *ngIf="empleado.usuario?.icon" [src]="empleado.usuario?.icon" style="border-radius: 50%;" #imgAvatar />
                                <div style="margin-left:20px">
                                    <br /> {{empleado?.primerApellido}} {{empleado?.primerNombre}} {{empleado?.segundoNombre}}
                                    <br /> {{empleado?.numeroIdentificacion}}
                                    <br /> {{empleado?.usuario.email}}
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </p-autoComplete>
                <label for="" class="active">Número de identificación</label>
            </div>
              <label class="s-float-label">Nombre</label>
              <input type="text" pInputText formControlName="codigo" required/>
    
              <label class="s-float-label">Cargo</label>
              <input type="text" pInputText formControlName="nombre" required/>
              
    
              <label class="s-float-label">Fecha de Validación</label>
              <p-calendar [monthNavigator]="true" [yearNavigator]="true" [yearRange]="yearRange" [locale]="es"
              dateFormat="dd/mm/yy" id="fechavistoing" formControlName="fechavistoing" required></p-calendar>
              
              <div >
                  <button  pButton type="button" (click)="(false)" icon="fa fa-check"  title="Validar como  supervision / Ingenieria" ></button>
              </div>
              
          </p-panel>
      </form>
    </div>
  -->
  <button pButton type="button" icon="fa fa-floppy-o" *ngIf="adicionar && solicitando == false" [disabled]="!formValid" (click)="onSubmit()"
    class="float-btn" data-toggle="tooltip" data-placement="bottom" title="Guardar"></button>

  <button pButton type="button" icon="fa fa-pencil" *ngIf="modificar && solicitando == false" [disabled]="!formValid" (click)="onSubmit()"
    class="float-btn ui-button-success" data-toggle="tooltip" data-placement="bottom" title="Modificar"></button>

  <p-progressSpinner *ngIf="solicitando == true" class="float-btn" strokeWidth="8" [style]="{width: '35px', height: '35px'}"></p-progressSpinner>

</div>





<div id="plantilla" style="display: none;">
  <div style="background-color: white">
    <table width="100%" style="border-collapse: collapse;">
      <tr>
        <td rowspan="2" style="width: 30%;border:solid thin #ccc;text-align: center">
          <img style="width:100%;" id="P_empresa_logo" />
        </td>        
        <td style="width: 55%;border:solid thin #ccc;text-align: center">
          SISTEMA DE GESTION DE SEGURIDAD Y SALUD EN EL TRABAJO
        </td>
        <td style="width: 15%;border:solid thin #ccc;text-align: center">
          Código: <label id="P_codigo"></label>
        </td>
      </tr>
      <tr>
        <td style="border:solid thin #ccc;text-align: center">
          <label id="P_lista_nombre"></label>
        </td>
        <td style="border:solid thin #ccc;text-align: center">
          Version <label id="P_version"></label>
        </td>
      </tr>
      <tr>
        
        <td  colspan="3" style="width: 30%;border:solid thin #ccc;text-align: center">      
          <div>
            <app-file-uploader *ngFor="let evidence of listaEvidence; let i = index" [img]="evidence" [index]="i"
                [show]="true" style="display:block;" width="20%" >
            </app-file-uploader>          
          </div>
        </td>        
        
      </tr>
      <tr>
        <td colspan="3" style="background-color:#eee;border:solid thin #ccc;padding: 8px;-webkit-print-color-adjust: exact;">
          <label id="P_formulario_nombre"></label>
        </td>
      </tr>
      <tr id="L_campos_formulario">
        <td style="border:solid thin #ccc;padding: 8px;">

        </td>
        <td style="border:solid thin #ccc;padding: 8px;" colspan="2">

        </td> 
      </tr>
    </table>
    <table width="100%" style="border-collapse: collapse;">
      <tr id="L_elementos_lista">
        <td id="C_codigo" style="border:solid thin #ccc;padding: 8px;">

        </td>
        <td id="C_nombre" style="border:solid thin #ccc;padding: 8px;">

        </td>
        <td id="C_opciones" style="border:solid thin #ccc;padding: 8px;">

        </td>
        <td id="C_recomendacion" style="border:solid thin #ccc;padding: 8px;">

        </td>
      </tr>
    </table>
    <table width="100%" style="border-collapse: collapse;">
      <tr>

      </tr>
      <tr>
        <td  colspan="1" style="width: 30%;border:solid thin #ccc;text-align: center">
          Firma <label id="P_version"></label>
        </td>
        <td  colspan="1" style="width: 30%;border:solid thin #ccc;text-align: center">      
          <div>
            <app-file-uploader *ngFor="let evidence of firma; let i = index" [img]="evidence" [index]="i"
                [show]="true" style="display:block;" width="30%" >
            </app-file-uploader>   
          </div>
        </td> 
        <td rowspan="1" style="width: 200px;border:solid thin #ccc;text-align: center">
              
          <label id="P_firma"></label>
        </td>
        
      </tr>
      
    </table>
  </div>
</div>