<div class="ui-g">
    <div class="ui-g-12 p-d-flex p-jc-between">
        <h5 class="title-header p-mb-2">Listado de seguimientos</h5>
        <button pButton type="button" (click)="showModalDialog('create')" label="Crear" class="ui-button-sm"></button>
    </div>

    <div class="ui-g-12">
        <p-table [value]="trackings">
            <ng-template pTemplate="header">
                <tr>
                    <th scope="col">Usuario</th>
                    <th scope="col">Descripción</th>
                    <th scope="col">Fecha de seguimiento</th>
                    <th scope="col">Acciones</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-tracking>
                <tr>
                    <td class="p-text-center">{{ tracking.user }}</td>
                    <td>{{ tracking.description }}</td>
                    <td class="p-text-center">{{ tracking.date | date:'shortDate' }}</td>
                    <td class="p-text-center">
                        <div pTooltip="Ver evidencias" style="display:inline-block;">
                            <button pButton type="button" (click)="showModalDialog('evidence', tracking)" icon="pi pi-eye" iconPos="left" class="ui-button-sm"></button>
                        </div>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>

</div>

<!-- Start create tarea modal -->

<p-dialog header="Crear nuevo seguimiento" styleClass="dialog-create" [(visible)]="displayModal" [modal]="true" [draggable]="false" [resizable]="false">

    <!-- Start content -->
    <form [formGroup]="trackingForm">
        <div class="ui-g">

            <div class="ui-g-12">
                <h5 class="title-header p-mb-2">Información</h5>
            </div>

            <div class="ui-g-12 ui-md-6">
                <div class="input-field">
                    <input pInputText formControlName="usuarioSeguimiento" styleClass="form-material">
                    <label for="" class="active">Usuario que realiza el seguimiento</label>
                </div>

                <!-- Start validations -->
                <div *ngIf="submitted && f.usuarioSeguimiento.hasError('required')" class="error-msg ">
                    <span>Debe buscar un usuario válido.</span>
                </div>
                <!-- End validations -->

            </div>

            <div class="ui-g-12 ui-md-6">
                <div class="input-field">
                    <input type="text" pInputText placeholder="Apellidos y nombres" class="form-material" id="nameAndLastName" [attr.disabled]="true" />
                    <label for="" class="active">Apellidos y nombres</label>
                </div>
            </div>

            <div class="ui-g-12 ui-md-6">
                <div class="input-field">
                    <p-calendar formControlName="fechaSeguimiento" [attr.disabled]="true" [monthNavigator]="true" [yearNavigator]="true" dateFormat="dd/mm/yy"></p-calendar>
                    <label for="" class="active">Fecha del seguimiento</label>
                </div>

                <!-- Start validations -->
                <div *ngIf="submitted && f.fechaSeguimiento.hasError('required')" class="error-msg ">
                    <span>Debe seleccionar una fecha de seguimiento.</span>
                </div>
                <!-- End validations -->

            </div>

            <div class="ui-g-12 ui-md-6">
                <div class="input-field">
                    <textarea pInputTextarea formControlName="descripcion" class="form-material" rows="3" required></textarea>
                    <label for="" class="active">Descripción del seguimiento</label>
                </div>

                <!-- Start validations -->
                <div *ngIf="submitted && f.descripcion.hasError('required')" class="error-msg ">
                    <span>Debe describir la acción realizada.</span>
                </div>
                <!-- End validations -->

            </div>

            <div class="ui-g-12">
                <h5 class="title-header p-mb-2">Evidencias</h5>
            </div>

            <div class="uploaders">
                <app-file-uploader *ngFor="let item of [0,1,2]; let i = index" [index]="i" (loadedImage)="addImage($event)"></app-file-uploader>
            </div>

        </div>
    </form>
    <!-- End content -->

    <!-- Start footer -->
    <p-footer>
        <p-button [icon]="(!cargando) ? 'pi pi-save' : 'pi pi-spinner pi-spin'" (click)="onSubmit()" [label]="(!cargando) ? 'Crear' : 'Creando'" styleClass="ui-button-rounded ui-button-text" [disabled]="cargando"></p-button>
        <p-button icon="pi pi-times" (click)="displayModal=false" label="Cancelar" styleClass="ui-button-rounded ui-button-secondary ui-button-text" [disabled]="cargando"></p-button>
    </p-footer>
    <!-- End footer -->

</p-dialog>

<!-- End create tarea modal -->

<!-- Start evidences modal -->

<p-dialog header="Evidencias" styleClass="dialog-evidences" [(visible)]="displayEvidences" [modal]="true" [closable]="false" [draggable]="false" [resizable]="false">

    <div class="uploaders-flex">
        <app-file-uploader *ngFor="let evidence of evidences; let i = index" [imgURL]="evidence" [show]="true"></app-file-uploader>
    </div>

    <!-- Start footer -->
    <p-footer>
        <p-button icon="pi pi-times" (click)="closeEvidences()" label="Cerrar" styleClass="ui-button-text"></p-button>
    </p-footer>
    <!-- End footer -->

</p-dialog>

<!-- End evidences modal -->